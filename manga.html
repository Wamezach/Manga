<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manga Details</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.2/dist/full.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="bg-base-200 text-base-content">
    <header class="bg-base-100 shadow-lg sticky top-0 z-50">
        <div class="navbar container mx-auto">
            <a href="index.html" class="btn btn-ghost text-2xl text-primary font-bold">MyManga</a>
        </div>
    </header>

    <main id="main-content" class="container mx-auto p-4 md:p-8">
        <!-- Loading Spinner -->
        <div class="flex justify-center mt-20"><span class="loading loading-spinner loading-lg text-primary"></span></div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const mainContent = document.getElementById('main-content');
            const mangaId = new URLSearchParams(window.location.search).get('id');

            if (!mangaId) {
                mainContent.innerHTML = '<p class="text-center text-error">No manga ID provided.</p>';
                return;
            }

            const apiUrl = `https://api.consumet.org/manga/mangadex/info?id=${mangaId}`;

            try {
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error('Failed to load manga details');
                const manga = await response.json();

                document.title = manga.title;

                mainContent.innerHTML = `
                    <div class="flex flex-col md:flex-row gap-8">
                        <img src="${manga.image}" alt="${manga.title}" class="w-48 h-72 object-cover rounded-lg shadow-lg"/>
                        <div class="flex-1">
                            <h1 class="text-4xl font-bold">${manga.title}</h1>
                            <p class="mt-4 text-gray-400">${manga.description}</p>
                        </div>
                    </div>
                    <div class="mt-8">
                        <h2 class="text-2xl font-bold mb-4">Chapters</h2>
                        <ul id="chapter-list" class="menu bg-base-100 rounded-box">
                            ${manga.chapters.map(chapter => `
                                <li><a href="reader.html?chapterId=${chapter.id}">${chapter.title}</a></li>
                            `).join('')}
                        </ul>
                    </div>
                `;
            } catch (error) {
                mainContent.innerHTML = '<p class="text-center text-error">Could not load details for this manga.</p>';
                console.error('Fetch error:', error);
            }
        });
    </script>
</body>
</html>